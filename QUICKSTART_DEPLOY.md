# Quick Start: Deploy to avatar-478217

## Your Project Setup

- **GCP Project ID:** `avatar-478217`
- **GitHub Repo:** https://github.com/kootru-repo/avatar-cloud
- **Region:** `us-central1`
- **Frontend URL:** https://avatar-478217.web.app (after deployment)
- **Backend URL:** Will be auto-generated by Cloud Run

## Configuration Already Updated

âœ… `.firebaserc` â†’ Project ID set to `avatar-478217`
âœ… `frontend/config.json` â†’ Firebase project ID updated
âœ… `frontend/config.json` â†’ Cloud Storage bucket set to `avatar-478217-videos`
âœ… `cloudbuild.yaml` â†’ Ready for CI/CD
âœ… `docker-compose.yml` â†’ Ready for local testing

## Three Ways to Deploy

### ðŸš€ Option 1: Fully Automated (Recommended) - 30 minutes

Follow the complete guide in **DEPLOY_NOW.md** which walks through:
1. Enable APIs
2. Store secrets
3. Initialize Firebase
4. Upload videos to Cloud Storage
5. Deploy backend to Cloud Run
6. Deploy frontend to Firebase Hosting
7. Set up auto-deploy from GitHub

### âš¡ Option 2: Quick Deploy (Manual) - 15 minutes

**Prerequisites:**
```bash
# Set environment variables
set PROJECT_ID=avatar-478217
set REGION=us-central1

# Authenticate
gcloud auth login
gcloud config set project avatar-478217
firebase login
```

**Deploy Backend:**
```bash
cd backend
gcloud run deploy gemini-avatar-backend --source . --region us-central1
```

**Deploy Frontend:**
```bash
cd ..
firebase deploy --only hosting
```

### ðŸ”¨ Option 3: Use Helper Scripts (Windows)

**1. Push to GitHub:**
```bash
PUSH_TO_GITHUB.bat
```

**2. Deploy Frontend:**
```bash
DEPLOY_FRONTEND.bat
```

**3. Check Status:**
```bash
CHECK_DEPLOYMENT.bat
```

---

## Immediate Next Steps (Choose Your Path)

### Path A: Full Production Deployment (40 mins)

1. **Open DEPLOY_NOW.md** and follow step-by-step
2. This sets up everything: secrets, Firebase, Cloud Storage, CI/CD
3. Best for a complete, production-ready deployment

### Path B: Quick Test Deployment (15 mins)

1. **Store your Gemini API Key:**
   ```bash
   echo YOUR_API_KEY | gcloud secrets create GEMINI_API_KEY --data-file=-
   ```

2. **Deploy Backend:**
   ```bash
   cd backend
   gcloud run deploy gemini-avatar-backend --source . --region us-central1 ^
       --set-secrets GEMINI_API_KEY=GEMINI_API_KEY:latest
   ```

3. **Get Backend URL and update frontend/config.json:**
   ```bash
   gcloud run services describe gemini-avatar-backend --region us-central1 --format="value(status.url)"
   ```
   Update `backend.wsUrl.cloud` in frontend/config.json

4. **Deploy Frontend:**
   ```bash
   firebase deploy --only hosting
   ```

5. **Test:** Visit https://avatar-478217.web.app

### Path C: Local Testing First (5 mins)

1. **Create backend/.env:**
   ```bash
   copy backend\.env.example backend\.env
   ```
   Edit `.env` and add your `GEMINI_API_KEY`

2. **Test locally with Docker:**
   ```bash
   docker-compose up --build
   ```

3. **Test frontend:**
   ```bash
   cd frontend
   python -m http.server 8000
   ```

4. **Visit:** http://localhost:8000

---

## What Still Needs Configuration

Before deploying, you need:

### 1. Gemini API Key
- Get from: https://makersuite.google.com/app/apikey
- Store in Secret Manager (see DEPLOY_NOW.md Step 3)

### 2. Firebase Web App Config
- After creating Firebase web app, update `frontend/config.json`:
  ```json
  "firebase": {
    "projectId": "avatar-478217",
    "appId": "GET-FROM-FIREBASE-CONSOLE",
    "apiKey": "GET-FROM-FIREBASE-CONSOLE",
    "authDomain": "avatar-478217.firebaseapp.com",
    "enabled": true
  }
  ```

### 3. Backend URL (After First Deploy)
- After deploying backend, update `frontend/config.json`:
  ```json
  "backend": {
    "wsUrl": {
      "local": "ws://localhost:8080",
      "cloud": "wss://YOUR-BACKEND-URL.run.app"
    }
  }
  ```

---

## Files Created for Deployment

| File | Purpose |
|------|---------|
| `DEPLOY_NOW.md` | Complete step-by-step deployment guide |
| `PUSH_TO_GITHUB.bat` | Push code to GitHub repo |
| `DEPLOY_FRONTEND.bat` | Deploy to Firebase Hosting |
| `CHECK_DEPLOYMENT.bat` | Check deployment status |
| `backend/Dockerfile` | Container for Cloud Run |
| `backend/.dockerignore` | Optimize Docker builds |
| `backend/.env.example` | Environment variable template |
| `backend/core/auth.py` | Firebase authentication |
| `cloudbuild.yaml` | Auto-deploy CI/CD pipeline |
| `firebase.json` | Firebase Hosting config |
| `.firebaserc` | Firebase project config |
| `docker-compose.yml` | Local cloud testing |
| `frontend/auth.js` | Firebase Auth integration |

---

## Deployment Checklist

### Before You Start:
- [ ] Gemini API Key ready
- [ ] `gcloud` CLI installed
- [ ] `firebase` CLI installed
- [ ] GitHub repo exists and accessible
- [ ] Billing enabled on GCP project

### Core Deployment:
- [ ] APIs enabled (Step 2 in DEPLOY_NOW.md)
- [ ] Secrets stored (Step 3)
- [ ] Firebase initialized (Step 5-7)
- [ ] Videos uploaded to Cloud Storage (Step 8)
- [ ] Backend deployed to Cloud Run (Step 9)
- [ ] Frontend config updated with backend URL (Step 10)
- [ ] Frontend deployed to Firebase (Step 14)

### Optional (but Recommended):
- [ ] CI/CD configured (Step 13)
- [ ] Auto-deploy from GitHub working
- [ ] Budget alerts set up
- [ ] Monitoring enabled

---

## Quick Commands

```bash
# Set project
gcloud config set project avatar-478217

# Deploy backend
cd backend && gcloud run deploy gemini-avatar-backend --source . --region us-central1

# Deploy frontend
firebase deploy --only hosting

# View logs
gcloud logs tail "resource.type=cloud_run_revision" --limit=50

# Check status
gcloud run services list --region us-central1
```

---

## Console Links

- **Cloud Run:** https://console.cloud.google.com/run?project=avatar-478217
- **Cloud Build:** https://console.cloud.google.com/cloud-build/builds?project=avatar-478217
- **Firebase:** https://console.firebase.google.com/project/avatar-478217
- **Storage:** https://console.cloud.google.com/storage/browser?project=avatar-478217
- **Secrets:** https://console.cloud.google.com/security/secret-manager?project=avatar-478217

---

## Need Help?

1. **Full Guide:** See DEPLOY_NOW.md
2. **Troubleshooting:** See DEPLOY_NOW.md "Troubleshooting" section
3. **Check Status:** Run `CHECK_DEPLOYMENT.bat`
4. **View Logs:** Visit Cloud Console logs page

---

## Recommended First Steps RIGHT NOW

1. **Read DEPLOY_NOW.md** (5 minutes) - Understand the full process
2. **Get your Gemini API Key** - https://makersuite.google.com/app/apikey
3. **Follow DEPLOY_NOW.md from Step 2** - Execute deployment step-by-step
4. **Or test locally first** - Run `docker-compose up` to validate everything works

The deployment infrastructure is ready. You just need to execute the steps!
